using Microsoft.EntityFrameworkCore;
using NetCoreMicroserviceSample.Api.Domain;
using System;

namespace NetCoreMicroserviceSample.Api.Repository
{
    public class MachineVisualizerDataContext : DbContext
    {
        public DbSet<Machine> Machines { get; set; }

        public DbSet<MachineSetting> MachineSettings { get; set; }
        public DbSet<MachineSwitch> MachineSwitches { get; set; }

#pragma warning disable CS8618 // Non-nullable field must contain a non-null value when exiting constructor. Consider declaring as nullable.
        public MachineVisualizerDataContext(DbContextOptions<MachineVisualizerDataContext> options)
#pragma warning restore CS8618 // Non-nullable field must contain a non-null value when exiting constructor. Consider declaring as nullable.
            : base(options)
        {
        }

        private const string HookOffsetPlaceholder = "#hookOfssetPlaceholder#";

        #region Images
        private const string CraneImage = @"
            <svg class=""machine"" xmlns=""http://www.w3.org/2000/svg"" viewBox=""0 0 906.4 980"">
                <g id=""Ebene_2"" data-name=""Ebene 2"">
                    <g id=""Ebene_1-2"" data-name=""Ebene 1"">
                        <g id=""crane"" >
                            <path
                              d=""M906.4,178.66V118.92H885c-14,0-21.84-.82-22.25-2.27-.41-1.24-105.06-28-232.37-59.12L398.6.47,333.71.06c-60.13-.21-65.28,0-71,3.5-3.3,2.06-57.06,27.6-119.48,56.86C81,89.47,28.44,114.6,26.58,116c-1.65,1.65-7,2.88-11.74,2.88H6.19v59.74H36.88l2.06,10.71c1.24,6,25.34,137,53.77,291.08s52.12,282.63,52.74,285.72l1.24,5.77H63.87v41.2H239v-41.2H155.54L127.94,486c-15-157.18-28-290.67-28.63-296.64l-1-10.71h151V118.92l-76.22-.41-76.43-.62,84.46-52.12C227.44,37.34,266,13.86,266.58,13.86s1.24,203.53,1.24,452.17V918.2h14.42V896.15L307,872.87c13.6-12.57,25.54-22.66,26.57-22.25,1,.21,12.57,10.3,25.54,22.25l23.69,21.63.21,11.74.21,12H397.6v-907l6.8,1.44c9.06,1.85,373.07,104.44,374.1,105.47.41.41-81.37.82-181.69.82H414.07v59.74h377M383.17,24.57V35.49L358.66,57.74c-13.6,12.36-25.34,22.25-26.37,22-.82-.21-12.56-10.3-25.75-22.45l-24.1-21.84V24.57l-.21-10.71H383.17ZM190.56,49.7c-2.27,1.44-26.37,16.48-53.56,33.17s-50.88,31.72-52.74,33.37c-2.47,2.06-8.45,2.68-23.48,2.27l-20.19-.62,75-35.43C187.47,48.67,199.42,43.31,190.56,49.7ZM320.34,90.08c.82,1.24-13.8,16.07-31.31,31.93l-6.8,6V54.64l18.54,16.89C311.07,80.81,319.72,89.25,320.34,90.08Zm62.42,18.33L382.14,127l-19.36-17.72L343.62,91.31l19.16-17.92,19.36-17.92.62,17.3C383,82.25,383,98.11,382.76,108.41ZM752.12,96.26c46.76,11.54,85.49,21.22,86.11,21.63.41.62-7.21,1-17.3,1-12.16,0-19.37-.82-21.43-2.68-1.85-1.65-32.55-10.92-68.19-21-58.09-16.07-69.42-19.57-65.51-19.57C666.42,75.66,705.36,84.93,752.12,96.26Zm-394.91,27.4,22.45,21.22-22,20.39c-12.15,11.33-22.87,21-24.1,21.22-1,.41-12.15-8.86-24.72-20.39l-23.07-21.42,22.45-21c12.36-11.54,23.48-21,24.51-21.22C333.94,102.44,344.85,111.91,357.21,123.66Zm-47.79,63c13.8,13.18,14.83,10.09-11.13,33.58l-16.07,14.42V161.35l7.83,7C294.18,172.27,303,180.51,309.42,186.69Zm73.75,11.74v36.26l-19.78-18.13-20-18.33,19.36-17.92c10.71-9.89,19.57-18.13,20-18.13C383,162.18,383.17,178.45,383.17,198.43Zm-291.08,6C102,301.85,136,659.47,135.56,660.91c-.41,1-20.6-106.3-45.11-238.55C65.93,289.9,46.36,180.92,46.77,180.1c.62-.83,10.3-1.24,21.84-1l21,.62Zm274.39,34.81,13.18,12.57-22.45,21C344.85,284.34,333.93,294,333.11,294c-1,0-11.95-9.48-24.51-21.22l-22.66-21,23.28-22,23.48-21.84,10.3,9.48C348.56,222.54,359.27,232.42,366.48,239.22Zm-59.33,51.71c8,7.42,14,14.21,13.39,15.24s-9.48,9.48-19.78,18.75l-18.54,16.89V269.09l5.36,4.12C290.47,275.48,299.33,283.51,307.15,290.93Zm76,14.62V341.6l-19.78-18.13-19.57-18.13L363,287.42c10.51-9.89,19.36-18.13,19.78-18.13C383,269.3,383.17,285.57,383.17,305.55Zm-19.57,37.5,16.48,15.25-22.66,21.42c-12.36,11.74-23.28,21.22-24.1,21.42-.62,0-11.54-9.48-24.31-21.22l-23.07-21,23.28-22L332.5,315l7.42,6.39C343.82,324.71,354.54,334.6,363.6,343.05Zm-58.71,52.73c8.45,7.62,15.66,14.83,16.07,15.66.21.82-8.24,9.48-19.16,19.36l-19.57,18.13V412.47C282.23,370.45,279.55,372.5,304.89,395.78Zm77.46,50.27c-.62.41-9.48-6.8-19.78-16.27l-18.75-17.3L363,394.35l19.16-18.13.62,34.4C383,429.57,382.76,445.43,382.35,446.05Zm-20,2.68,17.72,16.48-22.66,21.42c-12.36,11.74-23.07,21.42-23.69,21.63-1.85,0-46.35-41-46.35-42.64,0-1,10.09-11.12,22.66-22.66l22.45-20.81,6.18,5.15C342.18,430.19,352.68,439.87,362.36,448.73Zm-58.3,52.94,18.33,17.1-18.54,17.3c-10.09,9.48-19.16,17.3-20,17.51-1,0-1.65-15.86-1.65-35.23s.82-34.81,1.85-34.4C284.91,484.16,294,492.19,304.06,501.67Zm78.7,34.81-.62,17.71-18.54-17.1c-10.09-9.48-18.54-17.72-18.54-18.54,0-.62,8.45-8.86,18.54-18.13l18.54-17.1.62,17.51C383,510.73,383,526.59,382.76,536.48Zm-21.22,18.13,18.54,17.51-18.54,17.51c-10.09,9.68-21,19.37-23.9,21.43l-5.15,4.12-22.66-20.6c-12.36-11.54-22.45-21.42-22.45-22.46s10.09-10.92,22.45-22.45l22.66-20.6,5.15,4.12C340.53,535.25,351.45,544.93,361.54,554.61Zm-57.68,53.56,18.33,17.3-17.1,16.07c-9.48,8.86-18.54,16.89-20,17.71-2.47,1.44-2.88-4.53-2.88-33.58,0-19.16.62-35,1.65-35C284.7,590.87,293.56,598.69,303.86,608.17Zm78.9,35.23-.62,17.92L363.6,644c-10.09-9.48-18.54-17.92-18.54-18.54,0-.82,8.45-9.06,18.54-18.54l18.54-17.31.62,18.13C383,617.65,383,633.71,382.76,643.4Zm-23.28,16.27L380.08,679l-17.72,16.48c-9.68,8.86-20.39,18.54-23.69,21.42l-6.18,5.15L310,701.49c-12.57-11.54-22.66-21.63-22.66-22.66,0-.82,10.09-10.92,22.45-22.25,17.72-16.27,23.07-20,25.75-18.54C337.44,639.28,348.15,648.75,359.48,659.67Zm-38.11,72.72c0,1-30.28,29.46-35.43,33-3.5,2.68-3.71,1.24-3.71-33.58V695.31l19.57,18.13C312.51,723.32,321.37,731.77,321.37,732.39Zm61.8.62v35.23l-6.59-5.56c-3.71-3.09-12.56-11.33-19.77-18.13l-13.19-12.36L362,715.09c9.89-9.48,18.75-17.1,19.78-17.3C382.55,697.78,383.17,713.64,383.17,733Zm-25.75,31.51,22.66,21.42-15.45,14.21c-8.45,7.83-19.16,17.72-23.69,21.63l-8.24,7.42-23.07-20.8c-12.56-11.54-23.07-21.63-23.07-22.25-.21-1.65,44.7-43,46.76-43C334.14,743.31,344.85,752.78,357.42,764.52Zm-36.05,74.37c0,1-24.72,24.31-32.34,30.9l-6.8,5.56V802.43l19.57,17.92C312.51,830.24,321.37,838.68,321.37,838.89Zm61.39,17.3-.62,18.75L363,857,343.62,839.3,363,821.38l19.16-17.92.62,17.1C383,830,383,846.1,382.76,856.19Z"" />
                            <path d=""M63.87,845.07v19.57H239V825.5H63.87v19.57Z"" />
                            <path d=""M63.87,898.63V918.2H239V879.06H63.87v19.57Z"" />
                            <path
                              d=""M15.66,938.6C14.22,940.66,0,977.94,0,979.18c0,.41,115.36.82,256.47.82s256.47-.62,256.27-1.65c0-.82-3.5-10.3-7.62-21l-7.83-19.57-240.2-.62C117.63,937,16.28,937.56,15.66,938.6Z"" />
                        </g>
                        <svg id=""hook"" x=""#hookOfssetPlaceholder#"">
                            <g id=""Ebene_1-2-2"" data-name=""Ebene 1-2"">
                                <path
                                  d=""M777.73,305.46c-9.27,0-13.8,2.68-13.8,8.28,0,1.85,11.13,16.69,24.72,33l24.72,29.66v12c0,15.45,3.09,22.66,16.27,37.49,12.36,14.42,13.6,21.84,5.15,31.93-9.68,11.54-22.87,6.8-27.81-10.09-2.47-8.24-2.68-8.24-12.77-8.24H783.93l1.44,8.45c3.71,23.07,17.1,35.43,38.31,35.43,20.8,0,35-12.57,36.67-32.55,1.24-14.83-1.85-23.07-14.83-37.9-10.32-12-11.35-13.88-12-24.59l-.62-11.74,25.13-30.49c14-16.89,25.34-30.9,25.34-31.52,1.58-2.84.85-4,0-5.63-1.65-3.09-6.59-3.43-14.42-3.43"" />
                                <path d=""M850.45,305.47H796.93"" />
                            </g>
                            <rect x=""786.59"" y=""177.89"" width=""10.34"" height=""127.57"" />
                            <rect x=""852.11"" y=""177.89"" width=""10.34"" height=""127.57"" />
                        </svg>
                    </g>
                </g>
            </svg>";
        #endregion

        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            base.OnModelCreating(modelBuilder);

            // Add demo data
            var machineGuid1 = Guid.NewGuid();
            modelBuilder.Entity<Machine>().HasData(new
            {
                Id = machineGuid1,
                Name = "Machine 1",
                Description = "Description 1",
                SvgImage = CraneImage.Replace(HookOffsetPlaceholder, "-130")
            });
            modelBuilder.Entity<Machine>().HasData(new
            {
                Id = Guid.NewGuid(),
                Name = "Machine 2",
                Description = "Description 2",
                SvgImage = CraneImage.Replace(HookOffsetPlaceholder, "0")
            });
            modelBuilder.Entity<Machine>().HasData(new
            {
                Id = Guid.NewGuid(),
                Name = "Machine 3",
                Description = "Description 3",
                SvgImage = CraneImage.Replace(HookOffsetPlaceholder, "30")
            });

            modelBuilder.Entity<MachineSetting>().HasData(new
            {
                Id = Guid.NewGuid(),
                MachineId = machineGuid1,
                Name = "Setting 1",
                Description = "Description Setting 1",
                Value = 5.6,
                PositionX = 40,
                PositionY = 89
            });

            modelBuilder.Entity<MachineSetting>().HasData(new
            {
                Id = Guid.NewGuid(),
                MachineId = machineGuid1,
                Name = "Setting 2",
                Description = "Description Setting 2",
                Value = 5.6,
                PositionX = 140,
                PositionY = 189
            });


            modelBuilder.Entity<MachineSwitch>().HasData(new
            {
                Id = Guid.NewGuid(),
                MachineId = machineGuid1,
                Name = "Switch 1",
                Description = "Switch Setting 1",
                Value = true,
                PositionX = 67,
                PositionY = 143
            });

            modelBuilder.Entity<MachineSwitch>().HasData(new
            {
                Id = Guid.NewGuid(),
                MachineId = machineGuid1,
                Name = "Switch 2",
                Description = "Switch Setting 2",
                Value = false,
                PositionX = 54,
                PositionY = 234
            });

        }
    }
}
